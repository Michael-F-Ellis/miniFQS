<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>miniFQS Component Validator</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            background: #f8f9fa;
        }

        .test-case {
            background: white;
            border: 1px solid #ddd;
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
        }

        .input-pane {
            width: 100%;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            height: 80px;
            font-family: monospace;
            border: 1px solid #ccc;
            padding: 8px;
        }

        .label {
            font-size: 0.75em;
            text-transform: uppercase;
            color: #888;
            font-weight: bold;
        }

        /* The component handles its own internal styling, but we can style the container */
        mini-fqs {
            border: 1px solid #eee;
            background: #fafafa;
        }
    </style>
</head>

<body>

    <h1>miniFQS Component Validator</h1>
    <p>Testing the Web Component implementation.</p>

    <div id="test-container"></div>

    <!-- Load the Component -->
    <script type="module" src="./mini-fqs.js"></script>

    <script>
        const testSuite = [
            {
                name: "Hodie Christus (Excerpt)",
                desc: "The example from the PDF. Tests colors, 3-line staff, and chromatic placement.",
                fqs: `Hodie Excerpt

; ; ; | ; ; ; | Ho -di e | - - - |
K&2  ^b b b |`
            },
            {
                name: "LilyPond Rule Check",
                desc: "No octave marks. Should jump octaves automatically to stay close.",
                fqs: `Interval Test

Start Down Up Up |
K0 c g c f |`
            },
            {
                name: "Accidental Colors",
                desc: "Sharp(Red), Flat(Blue), Natural(Black), Dbl(Orange/Green).",
                fqs: `Color Test

Red Blue Black Org Grn |  *** *** *** *** | *** *** *** *** |
K0 #a &b %c ##d &&e | /c#cd #def #fg#g a#ab | cb&b a&ag &gfe &ed&d |`
            },
            {
                name: "Rhythm & Counter",
                desc: "Multi-beat tuplets (2Long) and Subdivisions (Short.short).",
                fqs: `Rhythm Math

2Long Start.sub |
K0 c c c |`
            },
            {
                name: "Full Structure",
                desc: "Multi-block test.",
                fqs: `Hodie Christus Natus Est

; ; ; | ; ; ; | Ho -di e | - - - | Ho -di e | Ho -di e |
K&2 | | | ^b b b | | b b b | b b b |

; ; ; | Chri - stus | na - - | - - - | * - - | * - - | * - - | tus - - | est - - |
K&2 | ^b b | b | | g | &a | c | c | b |

Ho -di e | - - - | Ho -di e | Ho -di e | ; ; Sal |
K&2 ^b b b | | b b b | b b b | b |

va - - | - - - | tur - - | a - - | pa - - | * - - | * - - | ru - - | it - - |
K&2 ^b | | g | &a | c | b | &a | c | b |

; ; ; | ; ; ; | ; ; ; | ; ; ; | ; ; ; |
K&2 |

- - - | - - lae | tan - - | tur - Arch | an * ge |
K&2 ^%b | %b | %b b | #c %b a |

li - ho | -di e ho | -di e ex | ul* * * | ** ** ** |
K&2 ^%b #c | %b b #c | %b b b | %b#c b a | %bab #cba |

* -* | ** ** tant ju* | sti di cen tes | glo -ri a in.ex |
K&2 ^ga | %bagf e fg | %a b c /f | bbbbb |

cel * * sis | De - o - | glo -ri a in.ex | cel * * * * sis | De - o - |
K&2 ^bc&dc | bb | fffff | fg&agfd | ff |

Glo -ri a in.ex | cel * * * 2*** | * *  sis | De - o ; |
K&2 fffff | fg&agagf | g f d | ff |

; ; Al* ** | ** ** le - | lu - * - ya - |
K&2 bcde | fg%ab c | g &a e |

al - - - - - | - - - le lu* ya | al - - - le - | lu - - - ya - |
K&2 f | gabc | bb | bb |`
            }
        ];

        const container = document.getElementById('test-container');

        testSuite.forEach((test, index) => {
            const div = document.createElement('div');
            div.className = 'test-case';

            div.innerHTML = `
                <div class="input-pane">
                    <span class="label">${test.name}</span>
                    <div style="font-size: 0.9em; color: #666; margin: 5px 0;">${test.desc}</div>
                    <textarea id="input-${index}">${test.fqs}</textarea>
                </div>
                <div class="output-pane">
                    <div class="label">Component Output</div>
                    <!-- The Component Instance -->
                    <mini-fqs id="fqs-${index}"></mini-fqs>
                </div>
            `;
            container.appendChild(div);

            const inputEl = document.getElementById(`input-${index}`);
            const component = document.getElementById(`fqs-${index}`);

            // Link Input to Component
            inputEl.addEventListener('input', () => {
                component.score = inputEl.value;
            });

            // Attributes are handled immediately, even before upgrade
            component.setAttribute('score', test.fqs);
        });
    </script>
</body>

</html>